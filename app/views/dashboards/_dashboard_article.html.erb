<div class="single-article <%= "single-article-unpublished" unless article.published %> <%= "single-article-archived" if article.archived %>">
  <div class="dashboard-collection-org-details">
    <% if article.organization_id %>
      <span class="dashboard-top-pill"><%= article.organization&.name %></span>
    <% end %>
    <% if article.collection_id %>
      <span class="dashboard-top-pill"><strong>Series:</strong> <%= article.series %></span>
    <% end %>
  </div>

  <div class="ellipsis-menu">
    <button class="ellipsis-menu-btn"><i class="material-icons">more_horiz</i></button>
    <ul class="ellipsis-menu hidden">
      <li class="ellipsis-menu-item">
        <%= form_for(article, url: "/article_mutes/#{article.id}", method: "patch", remote: true) do |f| %>
          <%= f.hidden_field :receive_notifications, value: !article.receive_notifications %>
          <%= f.submit article.receive_notifications ? "Mute Notifications" : "Receive Notifications" %>
        <% end %>
      </li>
      <hr />
      <li class="ellipsis-menu-item">
        <%= form_for(article, method: "patch", remote: true) do |f| %>
          <%= f.hidden_field :archived, value: !article.archived %>
          <%= f.submit article.archived ? "Unarchive Article" : "Archive Article" %>
        <% end %>
      </li>
    </ul>
  </div>

  <a href="<%= article.current_state_path %>"><h2><%= article.title %></h2></a>
  <div class="dashboard-meta-details">
    <% if article.published %>
      <%= article.readable_publish_date %>
      <% article.cached_tag_list_array.each do |tag| %>
        <a href="/t/<%= tag %>"><span class="tag">#<%= tag %></span></a>
      <% end %>
    <% end %>
  </div>
  <div class="dashboard-actions">
    <% if !article.published %>
      <a href="<%= article.current_state_path %>" class="pill cta yellow">DRAFT</a>
    <% end %>
    <a href="<%= article.path %>/edit" class="pill cta green">EDIT</a>
    <a href="<%= article.path %>/delete_confirm" data-no-instant class="cta pill black">DELETE</a>
    <% if article.published %>
      <span id="pageviews-<%= article.id %>" class="cta pill dashboard-pageviews-indicator" data-analytics-pageviews data-article-id="<%= article.id %>">
        <span class='page-views-count'>
          <span class="value">
            <% if article.page_views_count > 100 %>
               <span class="value"><%= article.page_views_count %></span>
            <% else %>
              under 100
            <% end %>
          </span>
          views
        </span>
        //
        <span class='reactions-count'>
          <span class="value">
            <%= article.positive_reactions_count %>
          </span>
          <%= "reaction".pluralize(count: article.positive_reactions_count) %>
        </span>
        //
        <span class='comments-count'>
          <span class="value">
            <%= article.comments_count %>
          </span>
          <%= "comment".pluralize(count: article.comments_count) %>
        </span>
      </span>
    <% end %>
  </div>
  <% if org_admin %>
    <%= form_for(article) do |f| %>
      <input type="hidden" name="destination" value="/dashboard" />
      AUTHOR: <%= f.select(:user_id, options_for_select(@user.organization.users.map { |x| [x.name, x.id] }, article.user_id)) %>
      <%= f.submit "SUBMIT AUTHOR CHANGE", class: "cta pill black" %>
    <% end %>
  <% end %>
</div>
