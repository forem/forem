<div 
  class="survey-poll <%= 'survey-poll-long-question' if poll.prompt_markdown.length > 128 %> <%= 'scale-horizontal scale-5-options' if poll.scale? && poll.poll_options.count == 5 %> <%= 'scale-horizontal scale-many-options' if poll.scale? && poll.poll_options.count > 5 %>" 
  id="survey-poll-<%= poll.id %>" 
  data-poll-id="<%= poll.id %>" 
  data-poll-index="<%= index %>"
  data-poll-type="<%= poll.type_of %>"
  style="display: none;"
>
  <h3><%= poll.prompt_html.html_safe %></h3>
  
  <% if poll.text_input? %>
    <!-- Text input poll -->
    <div class="survey-text-input-container">
      <textarea 
        id="survey-text-input-<%= poll.id %>"
        class="survey-text-input"
        placeholder="Enter your response here..."
        maxlength="1000"
        rows="4"
        style="width: 100%; padding: 12px; border: 1px solid var(--form-border); border-radius: var(--radius-md); resize: vertical;"
      ></textarea>
      <div class="survey-text-input-feedback" style="display: none; margin-top: 10px; padding: 10px; background-color: var(--cta-branded-bg); border-left: 4px solid var(--cta-branded-border); color: var(--cta-branded-color); border-radius: var(--radius-sm);">
        ✓ Thank you for your response.
      </div>
    </div>
  <% else %>
    <!-- Regular poll options -->
    <ul class="survey-poll-answers">
      <% 
        # Sort scale options numerically by their markdown value
        options = if poll.scale?
          poll.poll_options.sort_by { |opt| opt.markdown.to_i }
        else
          poll.poll_options
        end
      %>
      <% options.each do |option| %>
        <li class="survey-poll-option" id="survey_poll_option_list_item_<%= option.id %>" data-option-id="<%= option.id %>">
          <% if poll.single_choice? %>
            <input type="radio" id="survey_poll_option_<%= option.id %>" name="survey_poll_<%= poll.id %>" value="<%= option.id %>" data-option-id="<%= option.id %>">
          <% elsif poll.multiple_choice? %>
            <input type="checkbox" id="survey_poll_option_<%= option.id %>" name="survey_poll_<%= poll.id %>" value="<%= option.id %>" data-option-id="<%= option.id %>">
          <% elsif poll.scale? %>
            <input type="radio" id="survey_poll_option_<%= option.id %>" name="survey_poll_<%= poll.id %>" value="<%= option.id %>" data-option-id="<%= option.id %>">
          <% end %>
          
          <label for="survey_poll_option_<%= option.id %>" class="option-text">
            <% if poll.scale? %>
              <span class="scale-value"><%= option.markdown %></span>
            <% else %>
              <%= option.processed_html.html_safe %>
            <% end %>
          </label>
        </li>
      <% end %>
    </ul>
  <% end %>
  
  <div class="survey-poll-feedback" style="display: none;">
    ✓ Thank you for your response.
  </div>

  <div class="survey-poll-final-vote-feedback" style="display: none;">
    ✓ Thank you for completing the survey!
  </div>
</div>